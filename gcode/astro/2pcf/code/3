#include<iostream>
#include<cmath>
#include<cstdlib>
#include<cstdio>
#include "tools.h"

using namespace std;

void galaxysphtocar(double * raarray, double * decarray, double * rarray, galaxy *galarray, long n)
{
    for (long i = 0; i < n; i++)
    {
        galarray[i].xyz[0] = rarray[i]*cos(decarray[i]*M_PI/180.)*sin(raarray[i]*M_PI/180.);
        galarray[i].xyz[1] = rarray[i]*cos(decarray[i]*M_PI/180.)*cos(raarray[i]*M_PI/180.);
        galarray[i].xyz[2] = rarray[i]*sin(decarray[i]*M_PI/180.);
    }
    return;
}

void init1darray(galaxy1d *g1d, galaxy *galarray, long n, int xyzp)
{
    for (int i = 0; i < n; i++)
    {
        g1d[i].loc = galarray[i].xyz[xyzp];
        g1d[i].galid = i;
        galarray[i].locorder[xyzp] = i;
    }
    return;
}

void quicksortgalaxy1d(galaxy1d *galo, galaxy *galarray, long n, long befnum, int xyzp)
{
    if (n >= 2)
    {
        int d = 0;
        for (int i = 1; i < n; i++)
        {
            if (galo[i].loc < galo[0].loc)
            {
                if (d != 0)
                {
                    galarray[galo[d].galid].locorder[xyzp] = befnum + i;
                    galarray[galo[i].galid].locorder[xyzp] = befnum + d;
                    galaxy1d temp;
                    temp.loc = galo[i].loc;
                    temp.galid = galo[i].galid;
                    galo[i].loc = galo[d].loc;
                    galo[i].galid = galo[d].galid;
                    galo[d].loc = temp.loc;
                    galo[d].galid = temp.galid;
                    d++;
                }
            }
            else
            {
                if (d == 0)
                {
                    d == i;
                }
            }
        }
        if (d==0)
        {
            d = n;
        }
        galarray[galo[0].galid].locorder[xyzp] = befnum+d-1;
        galarray[galo[d-1].galid].locorder[xyzp] = befnum;
        galaxy1d temp;
        temp.loc = galo[d-1].loc;
        temp.galid = galo[d-1].galid;
        galo[d-1].loc = galo[0].loc;
        galo[d-1].galid = galo[0].galid;
        galo[0].loc = temp.loc;
        galo[0].galid = temp.galid;

        quicksortgalaxy1d(galo,galarray,d-1,befnum,xyzp);
        quicksortgalaxy1d(&galo[d],galarray,n-d,befnum+d,xyzp);
    }
    return;
}

double redshift(double z)
{
    double OmegaLambda = 0.718, Omegam = 0.282;
    return 1/pow((OmegaLambda+Omegam*pow(1+z,3)),0.5);
}


double trapequadrature(double bottom, double top, int n, double (*f)(double))
{
    double step = (top - bottom)/n;
    double sum = 0;
    for (int i = 1; i < n; i++)
    {
        sum += f(bottom+i*step)*step;
    }
    sum += (f(bottom)+f(top))*step/2;
    return sum;
}

/*
double test(double x)
{
    return 1/x;
}

int main()
{
    double integral;
    integral = trapequadrature(1,10,800,test);
    cout << integral << endl;
    printf("%.8f",M_PI);
    return 0;
}*/
